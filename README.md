I'm still working on it. The core issue is that the standard automatic sizing (UICollectionViewFlowLayout.automaticSize) is not compatible with our current layout implementation. To solve this properly, we need to evaluate migrating to UICollectionViewCompositionalLayout. This would allow us to handle the layout declaratively, without manual calculations, which would greatly simplify the logic, which would simplify things but may require some refactoring. The investigation is still in progress.
